/* Tailwind layers (preflight is disabled) */
@tailwind base;
@tailwind components;
@tailwind utilities;

/* Mapbox GL CSS for the interactive map placeholder */
@import "mapbox-gl/dist/mapbox-gl.css";

/* ---------- Globals ---------- */
:root { color-scheme: light; }
body {
  background: #fafcfc;
  font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, Noto Sans, "Apple Color Emoji", "Segoe UI Emoji";
}

/* Prevent horizontal page movement: keep layout responsive but disallow left-right scrolling.
   This ensures the UI adapts to viewport width without enabling unintended horizontal pan. */
html, body, #__next {
  overflow-x: hidden;
}

/* Admin UI refinements */
/* Admin layout variables: sidebar width and footer height used site-wide */
:root { --admin-sidebar-width: 14rem; --admin-footer-height: 48px; }
/* Driver-specific accent used in driver greeting and status indicators */
:root { --driver-accent: #02665e; }
/* Reserve a footer height so fixed elements (sidebar, floating actions) can sit above it without overlapping
  This enables a "sticky" footer behavior: the footer is at the end of the document but fixed UI will stop
  above it when visible. Adjust this value to match the visual footer height. */
:root { --footer-height: 56px; }
/* Global header height for fixed header offset (used by public pages) */
:root { --header-height: 4rem; }

/* Floating help: positioned above the footer using the footer height variable */
.floating-help {
  position: fixed;
  right: 1rem;
  bottom: calc(var(--admin-footer-height) + 12px);
  z-index: 50;
}

/* Fixed admin sidebar that stops above the pinned footer */
.admin-sidebar-fixed {
  position: fixed;
  left: 0;
  top: 0;
  bottom: 0; /* extend to bottom so the left column is continuous to the viewport bottom */
  width: var(--admin-sidebar-width);
  height: 100vh; /* ensure full viewport height */
  overflow: visible; /* allow inner scroll container to scroll independently */
  z-index: 80 !important; /* ensure sidebar always sits above footer rail and content */
}
/* Slightly smaller sidebar font to allow more items to remain visible when footer appears */
.admin-sidebar-fixed { font-size: 0.875rem; }
.admin-sidebar-fixed .sidebar-scroll a,
.admin-sidebar-fixed .sidebar-scroll button,
.admin-sidebar-fixed .sidebar-scroll .nav-item { font-size: inherit; }

/* Ensure the sidebar always uses the brand dark background and inner panels don't show white */
.admin-sidebar-fixed {
  background-color: #02665e !important;
  color: #ffffff !important;
}
.admin-sidebar-fixed .sidebar-scroll { background: transparent !important; padding-bottom: var(--admin-footer-height); overflow-y: auto; max-height: calc(100vh - 4rem - var(--admin-footer-height)); }
.admin-sidebar-fixed a, .admin-sidebar-fixed button { color: inherit !important; }
.admin-sidebar-fixed .bg-white { background: transparent !important; }
.admin-sidebar-fixed .card, .admin-sidebar-fixed .card-section {
  background: transparent !important;
  border-color: transparent !important;
  box-shadow: none !important;
}

/* Neutralize common light/white utility backgrounds inside the admin sidebar so inner panels
   don't show up as white, but allow intentional active/hover backgrounds (brand colors) to work. */
.admin-sidebar-fixed [class*="bg-white"],
.admin-sidebar-fixed .bg-gray-50,
.admin-sidebar-fixed .bg-gray-100,
.admin-sidebar-fixed .bg-neutral-100,
.admin-sidebar-fixed .bg-amber-50,
.admin-sidebar-fixed .bg-sky-50,
.admin-sidebar-fixed .bg-emerald-50 {
  background: transparent !important;
}

/* Make borders inside the sidebar subtle so inner panels keep structure without bright whites */
.admin-sidebar-fixed .border,
.admin-sidebar-fixed [class*="border-"] {
  border-color: rgba(255,255,255,0.06) !important;
}

/* Inputs, buttons, modals, cards, alerts inside the sidebar should blend with sidebar color */
.admin-sidebar-fixed input,
.admin-sidebar-fixed textarea,
.admin-sidebar-fixed select,
.admin-sidebar-fixed .btn,
.admin-sidebar-fixed .modal-card,
.admin-sidebar-fixed .qlink,
.admin-sidebar-fixed .alert-icon {
  background: transparent !important;
  border-color: transparent !important;
  box-shadow: none !important;
  color: inherit !important;
}

/* Hide decorative pseudo-elements inside the sidebar */
.admin-sidebar-fixed *::before,
.admin-sidebar-fixed *::after {
  background: transparent !important;
}

/* Helper to ensure footer inner content keeps a predictable height for layout offsets */
.footer-inner {
  min-height: var(--footer-height);
  display: flex;
  align-items: center;
  padding-top: 0.25rem;
  padding-bottom: 0.25rem;
}

/* Layout helpers used by admin layout */
.content-with-footer { padding-bottom: var(--admin-footer-height); }
.admin-footer-fixed { position: relative; z-index: 20; }
.mini-footer-above { position: fixed; right: 1.5rem; bottom: calc(var(--admin-footer-height) + 1rem); z-index: 30; }

/* Content area helper: adds bottom padding equal to footer height so page content isn't obscured */
.content-with-footer { padding-bottom: var(--admin-footer-height); }

/* Fixed footer helper: full-width, pinned to bottom, with rail already defined by .footer-with-rail */
.admin-footer-fixed { position: fixed; left: 0; right: 0; bottom: 0; height: var(--admin-footer-height); z-index: 40; }
.admin-footer-fixed .footer-inner { height: 100%; display: flex; align-items: center; }

/* Mini footer and floating widgets should sit above the pinned footer */
.mini-footer-above { position: fixed; right: 1.5rem; bottom: calc(var(--admin-footer-height) + 12px); z-index: 45; }

.help-button {
  @apply inline-flex items-center justify-center h-10 w-10 rounded-full bg-indigo-600 text-white shadow-lg hover:brightness-95 focus:outline-none focus:ring-2 focus:ring-indigo-400;
}


/* Rich text helpers */
/* Avoid @apply on `prose` (typography plugin) to prevent circular dependency */
.prose { max-width: none; }

/* ---------- Components ---------- */
@layer components {
  /* Cards */
  .card         { @apply bg-white rounded-2xl border border-gray-200 shadow-card; }
  .card-section { @apply p-4 sm:p-6; }

  /* Buttons (base + variants) */
  .btn { @apply inline-flex items-center justify-center gap-2 rounded-lg px-4 py-2 text-sm font-medium transition border border-blue-200 hover:border-blue-300; }
  .btn:disabled { @apply opacity-60 cursor-not-allowed; }

  .btn-brand, .btn-solid { @apply bg-brand text-white border-brand hover:brightness-95; }
  .btn-info              { @apply bg-info text-white border-info hover:brightness-110; }
  .btn-info-outline      { @apply bg-white text-info border-info hover:bg-info/5; }
  .btn-success           { @apply bg-success text-white border-success hover:brightness-110; }
  .btn-danger            { @apply bg-danger text-white border-danger hover:brightness-110; }
  .btn-outline           { @apply bg-white text-brand border-brand hover:bg-brand/5; }
  .btn-ghost             { @apply bg-transparent text-gray-700 border-transparent hover:bg-gray-50 hover:border-gray-200; }

  /* Badges */
  .badge         { @apply inline-flex items-center rounded-full border px-2 py-0.5 text-xs font-medium; }
  .badge-muted   { @apply text-gray-700 bg-gray-50 border-gray-200; }
  .badge-info    { @apply text-info bg-sky-50 border-sky-200; }
  .badge-success { @apply text-success bg-emerald-50 border-emerald-200; }
  .badge-warning { @apply text-amber-800 bg-amber-50 border-amber-200; }
  .badge-danger  { @apply text-danger bg-rose-50 border-rose-200; }

  /* Stat cards with gradient rail + hover lift */
  .stat-card { @apply relative overflow-hidden rounded-2xl bg-white border border-gray-200 shadow-card transition-all; }
  .stat-card:hover { @apply -translate-y-0.5 shadow-[0_10px_20px_rgba(0,0,0,.08),_0_6px_6px_rgba(0,0,0,.06)]; }
  .stat-card::after {
    content:""; position:absolute; inset:0 auto 0 0; width:10px;
    border-top-left-radius:inherit; border-bottom-left-radius:inherit;
    background: linear-gradient(to bottom, var(--rail-from), var(--rail-to));
  }
  .rail-brand   { --rail-from: theme('colors.brand.500');    --rail-to: theme('colors.brand.700'); }
  .rail-info    { --rail-from: theme('colors.info.DEFAULT'); --rail-to: #011366; }
  .rail-success { --rail-from: theme('colors.success.DEFAULT'); --rail-to: #127d3a; }
  .rail-danger  { --rail-from: theme('colors.danger.DEFAULT');  --rail-to: #b91c1c; }

  .stat-body  { @apply pl-5 pr-5 py-4 sm:py-5 sm:pl-6; }
  .stat-top   { @apply flex items-center gap-3; }
  .stat-icon  { @apply inline-flex h-9 w-9 items-center justify-center rounded-full border bg-gradient-to-tr from-gray-50 to-white; }
  .stat-label { @apply text-sm text-gray-600; }
  .stat-value { @apply mt-2 text-3xl sm:text-4xl font-semibold tracking-tight text-gray-900; }
  .stat-help  { @apply mt-2 text-xs text-gray-500; }

  /* Greeting accent: thin left rail, right rail (double-rail) and inner padding to match header brand */
  .greeting-accent {
    position: relative;
    border-left: 6px solid var(--driver-accent);
    padding-left: 1rem;
    padding-right: 1rem; /* space for right rail so content doesn't overlap */
  }

  /* Right rail implemented with a pseudo-element for symmetry */
  .greeting-accent::after {
    content: '';
    position: absolute;
    right: 0.5rem; /* inset from edge to align visually with left rail */
    top: 12px;
    bottom: 12px;
    width: 6px;
    border-top-right-radius: 8px;
    border-bottom-right-radius: 8px;
    /* Lighter, more subtle right rail to avoid overpowering the header */
    background: linear-gradient(to bottom, rgba(2,102,94,0.28), rgba(2,102,94,0.12));
    pointer-events: none;
  }

  /* Normalize driver page inner containers: remove ad-hoc left margins and pin content to the left
     so lists/tables (Invoices, Trips) appear visually connected to the driver sidebar. This is
     a CSS-only override that tightens left/right padding and adds a subtle left rail for emphasis. */
  @media (min-width: 768px) {
    .admin-sidebar-fixed + .flex-1 > main > div {
      margin-left: 0 !important;
      margin-right: auto !important;
      max-width: 72rem; /* content width for driver pages */
      padding-left: 0.5rem !important; /* tighten left padding so content sits nearer the sidebar */
      padding-right: 0.5rem !important; /* tighten right padding to squeeze content */
      position: relative; /* allow pseudo-element rail */
    }

    /* Subtle left rail on the content wrapper to visually connect content to the sidebar */
    .admin-sidebar-fixed + .flex-1 > main > div::before {
      content: '';
      position: absolute;
      left: 0.25rem;
      top: 12px;
      bottom: 12px;
      width: 4px;
      border-radius: 4px;
      background: linear-gradient(to bottom, rgba(2,102,94,0.12), rgba(2,102,94,0.06));
      pointer-events: none;
    }

    /* If page inner wrapper uses a right border (pr-2 border-r), reduce its extra padding slightly */
    .admin-sidebar-fixed + .flex-1 > main > div > .pr-2 {
      padding-right: 0.5rem !important;
    }
  }

  /* Status dot used in driver header: online/offline variants */
  .status-dot { @apply inline-block h-3 w-3 rounded-full; background: #9ca3af; }
  .status-dot.online { background: var(--driver-accent); }
  .status-dot.offline { background: #9ca3af; }

  /* Quick links: make tiles visually distinct, equal height, with subtle border and hover lift */
  .qlink {
    /* Make tiles respect siblings: full-size within grid cell but constrained, box-sizing prevents padding bleed */
    box-sizing: border-box;
    @apply flex items-center rounded-xl border bg-white px-3 py-2 text-sm font-medium transition-all hover:-translate-y-0.5 hover:shadow-card h-full min-h-[56px] max-h-[140px];
    display: flex; /* ensure flex layout for content centering */
    align-items: center;
    justify-content: center;
    gap: 8px; /* slightly tighter gap between icon and label */
    text-decoration: none; /* remove underline */
    position: relative; /* for tooltip positioning */
  }

  /* Ensure labels truncate instead of wrapping and pushing sibling tiles */
  .qlink > span {
    display: block;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    margin-left: 4px; /* bring label closer to icon */
    max-width: calc(100% - 36px); /* leave space for icon */
  }

  /* Reveal full label as a floating tooltip when the tile is hovered or focused */
  .qlink:hover, .qlink:focus-within { z-index: 40; }
  /* Instead of showing a floating popup, allow the label to wrap inside the tile on hover/focus */
  .qlink-popup { display: none !important; }
  .qlink-wrapper:hover > .qlink > span, .qlink-wrapper:focus-within > .qlink > span {
    white-space: normal;
    overflow: visible;
    text-overflow: clip;
    max-width: 100%;
    display: block;
  }
  /* keep label color and background unchanged (no extra white popup) */
  .qlink-wrapper > .qlink > span { background: transparent; }

  /* Popup header/body styles (plain CSS to avoid unknown Tailwind tokens) */
  .qlink-popup {
    border: 1px solid rgba(15, 23, 42, 0.06); /* subtle border */
    border-radius: 0.375rem;
    background: #ffffff;
    overflow: visible;
  }
  .qlink-popup .qlink-popup-header {
    background: rgba(2,102,94,0.06); /* light brand tint */
    font-size: 0.875rem;
    color: #064e45; /* darker brand tint */
    border-top-left-radius: 0.375rem;
    border-top-right-radius: 0.375rem;
    padding: 0.25rem 0.5rem;
  }
  .qlink-popup .qlink-popup-body {
    padding: 0.5rem 0.5rem;
    color: #111827;
  }

  /* Make grid rows distribute space evenly but allow internal overflow to be clipped */
  .card > .card-section > .grid {
    grid-auto-rows: minmax(0, 1fr);
  }

  /* Inputs */
  .input    { @apply rounded-md border border-gray-300 bg-white px-3 py-2 shadow-sm focus:outline-none focus:ring-2 focus:ring-brand/30 focus:border-brand; }
  .select   { @apply input; }
  .textarea { @apply input; }

  /* GroupStays specific small helpers moved from component inline styles */
  .groupstays-select {
    -moz-appearance: none !important;
    -webkit-appearance: none !important;
    appearance: none !important;
    background: transparent !important;
    background-image: none !important;
    padding-right: 2.25rem; /* Tailwind pr-9 */
    box-sizing: border-box;
    min-height: 2.5rem; /* ensure consistent height with selects */
    line-height: 1.25rem;
  }
  .groupstays-select::-ms-expand { display: none !important; }
  .groupstays-select::-moz-focus-inner { border: 0; }
  .groupstays-chevron { filter: none; pointer-events: none; right: 0.65rem; }

  /* GroupStays component layout: scoped to the component using aria-labelledby selector */
  [aria-labelledby="group-stays-heading"] .groupstays-section {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
  }
  [aria-labelledby="group-stays-heading"] .groupstays-section > label,
  [aria-labelledby="group-stays-heading"] .groupstays-section > .text-xs {
    color: #475569; /* slate-600 */
    font-size: 0.75rem;
  }
  [aria-labelledby="group-stays-heading"] .groupstays-section input[type="number"],
  [aria-labelledby="group-stays-heading"] .groupstays-section input[type="time"],
  [aria-labelledby="group-stays-heading"] .groupstays-section .groupstays-select,
  [aria-labelledby="group-stays-heading"] .groupstays-section textarea {
    min-height: 2.5rem;
    padding: 0.5rem 0.75rem;
    border-radius: 0.375rem;
    border: 1px solid rgba(15,23,42,0.06);
    background: #ffffff;
    box-sizing: border-box;
  }
  [aria-labelledby="group-stays-heading"] .groupstays-section .groupstays-select {
    padding-right: 2.25rem; /* keep chevron space */
    line-height: 1.25rem;
  }
  [aria-labelledby="group-stays-heading"] .private-room-row {
    display: flex;
    gap: 1rem;
    align-items: center;
    flex-wrap: wrap;
  }
  [aria-labelledby="group-stays-heading"] .private-room-row .w-20 { min-width: 5rem; }
  /* Slightly tighten spacing for recommendation badge area */
  [aria-labelledby="group-stays-heading"] .RecommendationBadge, [aria-labelledby="group-stays-heading"] .recommendation-badge {
    margin-top: 0.25rem;
  }

  /* Arrangements UI: pill toggles, icons and summary badges */
  [aria-labelledby="group-stays-heading"] .arrangements-summary { display:flex; gap:0.5rem; align-items:center; flex-wrap:wrap; margin-top:0.25rem; }
  [aria-labelledby="group-stays-heading"] .arrangements-summary .pill-badge {
    background: rgba(2,102,94,0.08);
    color: #064e45;
    padding: 0.25rem 0.5rem;
    border-radius: 999px;
    font-size: 0.75rem;
    display:inline-flex; align-items:center; gap:0.4rem;
  }

  [aria-labelledby="group-stays-heading"] .arrangements-grid { display:grid; grid-template-columns: repeat(2, minmax(0,1fr)); gap:0.5rem; margin-top:0.5rem; }
  @media (min-width: 768px) { [aria-labelledby="group-stays-heading"] .arrangements-grid { grid-template-columns: repeat(3, minmax(0,1fr)); } }

  .arrangement-pill {
    display:inline-flex; align-items:center; gap:0.5rem; padding:0.45rem 0.75rem; border-radius:0.5rem; border:1px solid rgba(15,23,42,0.06);
    background:#fff; color:#0f172a; cursor:pointer; font-size:0.9rem; transition:transform .14s cubic-bezier(.2,.9,.2,1), box-shadow .14s ease, background-color .12s ease, color .12s ease; box-shadow: 0 1px 0 rgba(15,23,42,0.02);
  }
  .arrangement-pill svg { width:1rem; height:1rem; opacity:0.9 }
  .arrangement-pill:hover { transform: translateY(-2px); box-shadow: 0 6px 14px rgba(2,6,23,0.06); }
  .arrangement-pill:active { transform: translateY(0) scale(0.995); }
  .arrangement-pill.selected { background: #059669; color: #fff; border-color: #059669; transform: translateY(-3px) scale(1.02); box-shadow: 0 10px 30px rgba(2,6,23,0.12); }
  .arrangement-pill:focus-visible { outline: none; box-shadow: 0 6px 20px rgba(2,6,23,0.08); transform: translateY(-2px); }

  /* Pickup details column tweaks inside arrangements block */
  [aria-labelledby="group-stays-heading"] .arrangements-details input,
  [aria-labelledby="group-stays-heading"] .arrangements-details textarea {
    border: 1px solid rgba(15,23,42,0.06); padding:0.5rem 0.75rem; border-radius:0.375rem; background:#fff;
  }

  /* Footer rail segments (Tanzania flag colors) moved from inline styles in PublicFooter.tsx */
  .footer-rail-seg { display: block; height: 100%; }
  .footer-rail-green { background-color: #007A3D; }
  .footer-rail-yellow { background-color: #FCD116; }
  .footer-rail-black { background-color: #000000; }
  .footer-rail-blue { background-color: #00A3E0; }

  /* Links */
  /* No underline; show bottom border color on hover to indicate interactivity */
  .link { @apply text-info border-b border-transparent transition-colors hover:border-info; }

  /* Tables */
  .table    { @apply w-full border-collapse text-sm; }
  .thead th { @apply bg-gray-50 text-left font-semibold border-b px-3 py-2; }
  .tbody td { @apply border-b px-3 py-2; }
  /* Driver-specific table tightening: reduce horizontal padding and force ellipsis for long values
     so invoice/trips tables stay compact and move visually closer to the sidebar. */
  @media (min-width: 768px) {
    .admin-sidebar-fixed + .flex-1 main table { table-layout: fixed; width: 100%; }
    .admin-sidebar-fixed + .flex-1 main table th,
    .admin-sidebar-fixed + .flex-1 main table td {
      padding-left: 0.5rem !important;
      padding-right: 0.5rem !important;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    .admin-sidebar-fixed + .flex-1 main table th.action,
    .admin-sidebar-fixed + .flex-1 main table td.action { width: 6rem; }
    .admin-sidebar-fixed + .flex-1 main table th.amount,
    .admin-sidebar-fixed + .flex-1 main table td.amount { width: 8rem; text-align: right; }
  }
  .row-hover { @apply transition-colors; }
  .row-hover:hover { @apply bg-gray-50; }

  /* Alerts */
  .alert        { @apply flex items-start gap-3 rounded-xl border p-3 sm:p-4; }
  .alert-icon   { @apply inline-flex h-6 w-6 items-center justify-center rounded-full bg-white/70 border; }
  .alert-title  { @apply text-sm font-semibold text-gray-900; }
  .alert-desc   { @apply text-sm text-gray-700; }
  .alert-info    { @apply border-info/30    bg-info/5; }
  .alert-success { @apply border-success/30 bg-success/5; }
  .alert-warning { @apply border-amber-300  bg-amber-50; }
  .alert-danger  { @apply border-danger/30  bg-danger/5; }

  /* Modal */
  .modal-backdrop { @apply fixed inset-0 z-40 bg-black/40; }
  .modal          { @apply fixed inset-0 z-50 flex items-center justify-center p-4; }
  .modal-card     { @apply bg-white rounded-2xl border border-gray-200 shadow-card w-full max-w-md; }
  .modal-head     { @apply px-5 pt-5 text-base font-semibold text-gray-900; }
  .modal-body     { @apply px-5 py-4 text-sm text-gray-700; }
  .modal-foot     { @apply px-5 pb-5 pt-3 flex justify-end gap-2; }

  /* Spinner */
  @keyframes spin { to { transform: rotate(360deg); } }
  .spinner {
    @apply inline-block h-5 w-5 rounded-full border-2 border-gray-300;
  border-right-color: theme('colors.brand.DEFAULT');
    animation: spin .7s linear infinite;
  }

  /* Dot-spinner: four colored dots rotating around a center (compact inline loader) */
  .dot-spinner {
    display: inline-block;
    width: 28px;
    height: 28px;
    position: relative;
    vertical-align: middle;
    transform-origin: center;
    animation: dot-rotate 1.2s linear infinite;
  }

  .dot-spinner .dot {
    width: 7px;
    height: 7px;
    border-radius: 9999px;
    position: absolute;
    left: 50%;
    top: 50%;
    transform: translate(-50%, -50%);
    box-shadow: 0 0 0 0 rgba(0,0,0,0);
    animation: dot-pulse 1s infinite ease-in-out;
  }

  /* place dots at N, E, S, W around the circle */
  .dot-spinner .dot:nth-child(1) { top: 6%; left: 50%; transform: translate(-50%, -50%); animation-delay: 0s; }
  .dot-spinner .dot:nth-child(2) { top: 50%; left: 94%; transform: translate(-50%, -50%); animation-delay: 0.12s; }
  .dot-spinner .dot:nth-child(3) { top: 94%; left: 50%; transform: translate(-50%, -50%); animation-delay: 0.24s; }
  .dot-spinner .dot:nth-child(4) { top: 50%; left: 6%; transform: translate(-50%, -50%); animation-delay: 0.36s; }

  /* colors: blue, black, yellow, green */

  /* Country name flag gradients used for Explore button text */
  .flag-text-tanzania {
    background-image: linear-gradient(135deg, #006a4e 0%, #006a4e 30%, #ffd100 30%, #ffd100 40%, #000000 40%, #000000 55%, #00a3dd 55%, #00a3dd 100%);
    -webkit-background-clip: text;
    background-clip: text;
    color: transparent;
    -webkit-text-fill-color: transparent;
  }

  .flag-text-kenya {
    background-image: linear-gradient(90deg, #000000 0%, #000000 22%, #ffffff 22%, #ffffff 28%, #d52b1e 28%, #d52b1e 62%, #ffffff 62%, #ffffff 68%, #006233 68%, #006233 100%);
    -webkit-background-clip: text;
    background-clip: text;
    color: transparent;
    -webkit-text-fill-color: transparent;
  }

  .flag-text-uganda {
    background-image: linear-gradient(90deg, #000000 0%, #000000 33%, #ffd100 33%, #ffd100 66%, #d52b1e 66%, #d52b1e 100%);
    -webkit-background-clip: text;
    background-clip: text;
    color: transparent;
    -webkit-text-fill-color: transparent;
  }

  /* Explore button zoom / lift effect (applied via .btn-explore) */
  .btn-explore {
    transition: transform 180ms cubic-bezier(.2,.9,.2,1), box-shadow 180ms cubic-bezier(.2,.9,.2,1);
    transform-origin: center;
    will-change: transform, box-shadow;
  }

  .btn-explore:hover,
  .btn-explore:focus {
    transform: translateY(-3px) scale(1.04);
    box-shadow: 0 10px 20px rgba(2,6,23,0.08), 0 4px 8px rgba(2,6,23,0.04);
    outline: none;
  }

  /* On touch devices the active state gives a quick scale for feedback */
  .btn-explore:active {
    transform: translateY(0) scale(0.98);
  }

  /* Respect reduce-motion preference */
  @media (prefers-reduced-motion: reduce) {
    .btn-explore,
    .btn-explore:hover,
    .btn-explore:focus,
    .btn-explore:active {
      transition: none !important;
      transform: none !important;
      box-shadow: none !important;
    }
  }

  /* Card interactive lift/scale for clickable cards */
  .card-raise {
    transition: transform 220ms cubic-bezier(.2,.9,.2,1), box-shadow 220ms cubic-bezier(.2,.9,.2,1);
    transform-origin: center;
    will-change: transform, box-shadow;
  }

  .card-raise:hover,
  .card-raise:focus-within {
    transform: translateY(-6px) scale(1.02);
    box-shadow: 0 18px 32px rgba(2,6,23,0.10), 0 6px 12px rgba(2,6,23,0.06);
    z-index: 10;
  }

  .card-raise:active {
    transform: translateY(-2px) scale(0.995);
  }

  @media (prefers-reduced-motion: reduce) {
    .card-raise, .card-raise:hover, .card-raise:focus-within, .card-raise:active {
      transition: none !important;
      transform: none !important;
      box-shadow: none !important;
    }
  }

  /* Bottom color rail highlighting on card hover for country flags */
  .flag-rail-tanzania::after,
  .flag-rail-kenya::after,
  .flag-rail-uganda::after {
    content: '';
    position: absolute;
    left: 0;
    right: 0;
    bottom: 0;
    height: 0px;
    transition: height 220ms cubic-bezier(.2,.9,.2,1), opacity 220ms ease;
    opacity: 0;
    pointer-events: none;
  }

  .flag-rail-tanzania::after {
    background: linear-gradient(135deg, #006a4e 0%, #006a4e 30%, #ffd100 30%, #ffd100 40%, #000000 40%, #000000 55%, #00a3dd 55%, #00a3dd 100%);
  }

  .flag-rail-kenya::after {
    background: linear-gradient(90deg, #000000 0%, #000000 22%, #ffffff 22%, #ffffff 28%, #d52b1e 28%, #d52b1e 62%, #ffffff 62%, #ffffff 68%, #006233 68%, #006233 100%);
  }

  .flag-rail-uganda::after {
    background: linear-gradient(90deg, #000000 0%, #000000 33%, #ffd100 33%, #ffd100 66%, #d52b1e 66%, #d52b1e 100%);
  }

  /* Expand the rail on interactive card states */
  .card-raise:hover.flag-rail-tanzania::after,
  .card-raise:focus-within.flag-rail-tanzania::after,
  .card-raise:hover.flag-rail-kenya::after,
  .card-raise:focus-within.flag-rail-kenya::after,
  .card-raise:hover.flag-rail-uganda::after,
  .card-raise:focus-within.flag-rail-uganda::after {
    height: 6px;
    opacity: 1;
  }

  /* Guest popover positioning (reads coordinates from CSS variables updated in JS) */
  .nolsaf-guest-popper {
    position: fixed;
    left: var(--nolsaf-guest-left, 50%);
    top: var(--nolsaf-guest-top, auto);
    width: var(--nolsaf-guest-width, auto);
    transform: translateX(0);
    max-width: calc(100% - 2rem);
  }
  /* Date popper: mirrors guest popper but has a mobile bottom-sheet fallback */
  .nolsaf-date-popper {
    position: fixed;
    left: var(--nolsaf-date-left, 50%);
    top: var(--nolsaf-date-top, auto);
    width: var(--nolsaf-date-width, auto);
    transform: translateX(0);
    max-width: calc(100% - 2rem);
  }
  /* Make the popper corners more rounded and add an outer rounded ring for visual separation */
  .nolsaf-date-popper {
    border-radius: 14px !important;
    overflow: visible !important; /* allow the outer ring shadow to render */
  }
  /* subtle outer rounded ring using a pseudo-element so the popper has a second rounded layer */
  .nolsaf-date-popper::before {
    content: "";
    position: absolute;
    left: -8px;
    top: -8px;
    right: -8px;
    bottom: -8px;
    border-radius: 18px !important;
    pointer-events: none;
    z-index: -1;
    box-shadow: 0 18px 40px rgba(2,6,23,0.09), 0 6px 16px rgba(2,6,23,0.06);
  }
  @media (max-width: 767px) {
    .nolsaf-date-popper {
      left: 0 !important;
      right: 0 !important;
      bottom: 0 !important;
      top: auto !important;
      width: 100% !important;
      max-width: 100% !important;
      /* for bottom-sheet on mobile, round the top corners to make it appear like a sheet */
      border-top-left-radius: 14px !important;
      border-top-right-radius: 14px !important;
      border-bottom-left-radius: 0 !important;
      border-bottom-right-radius: 0 !important;
    }
  }

  /* Mobile sheet grabber: small centered rounded bar to indicate draggable sheet */
  .nolsaf-sheet-grabber-wrapper { display: none; }
  @media (max-width: 767px) {
    .nolsaf-sheet-grabber-wrapper {
      display: flex !important;
      justify-content: center !important;
      align-items: center !important;
      padding-top: 8px !important;
      padding-bottom: 6px !important;
    }
    .nolsaf-sheet-grabber {
      width: 44px !important;
      height: 5px !important;
      border-radius: 9999px !important;
      background: rgba(15,23,42,0.08) !important;
      box-shadow: 0 1px 0 rgba(255,255,255,0.6) inset !important;
    }
  }
  /* Ensure DayPicker displays multiple months side-by-side for a clear flow */
  /* Target both the .rdp and .rdp-months containers depending on DayPicker version */
  .nolsaf-date-popper .rdp,
  .nolsaf-date-popper .rdp-months {
    display: flex !important;
    flex-direction: row !important;
    gap: 0.75rem !important;
    align-items: flex-start !important;
    justify-content: center !important;
    padding: 0.25rem !important;
    flex-wrap: nowrap !important;
  }
  .nolsaf-date-popper .rdp-month,
  .nolsaf-date-popper .rdp-months > * {
    flex: 1 1 0 !important;
    min-width: 260px !important;
  }
  /* Give each month a clear card boundary so they don't visually overflow into one another */
  .nolsaf-date-popper .rdp-month {
    background: #ffffff;
    border: 1px solid rgba(15,23,42,0.06);
    border-radius: 10px !important;
    padding: 0.5rem !important;
    box-sizing: border-box !important;
    overflow: hidden !important;
    display: flex !important;
    flex-direction: column !important;
    min-height: 260px;
  }
  /* Keep the table inside each month constrained and responsive */
  .nolsaf-date-popper .rdp-month .rdp-table {
    width: 100% !important;
    box-sizing: border-box !important;
    overflow: hidden !important;
  }
  /* Slight separation visual between months */
  .nolsaf-date-popper .rdp-month + .rdp-month {
    margin-left: 0.5rem !important;
  }
  .nolsaf-date-popper .rdp-caption {
    text-align: center !important;
    display: flex !important;
    align-items: center !important;
    justify-content: space-between !important;
    gap: 0.5rem !important;
  }
  /* Navigation buttons (prev/next) inline with the month caption */
  .nolsaf-date-popper .rdp-nav {
    display: inline-flex !important;
    gap: 0.25rem !important;
    align-items: center !important;
  }

  /* Force caption label and nav to sit on the same line and keep the month label left-aligned */
  .nolsaf-date-popper .rdp-caption,
  .nolsaf-date-popper .rdp-month .rdp-caption {
    display: flex !important;
    flex-direction: row !important;
    align-items: center !important;
    justify-content: space-between !important;
    gap: 0.5rem !important;
    flex-wrap: nowrap !important;
    position: relative !important; /* allow absolutely positioned nav */
  }
  .nolsaf-date-popper .rdp-caption_label,
  .nolsaf-date-popper .rdp-caption > .rdp-caption_label {
    order: 1 !important;
    flex: 1 1 auto !important;
    text-align: left !important;
    font-weight: 600 !important;
    white-space: nowrap !important;
    overflow: hidden !important;
    text-overflow: ellipsis !important;
    min-width: 0 !important; /* allow flex shrink */
    display: inline-block !important;
    padding-right: 56px !important; /* reserve space for nav on the right */
  }
  /* Pin the nav (prev/next buttons) to the far right of the caption row */
  .nolsaf-date-popper .rdp-nav {
    display: none !important; /* hide built-in DayPicker nav inside our popper (we use custom nav) */
  }
  /* Also hide any nav buttons inside the rdp header so only our independent chevron is visible */
  .nolsaf-date-popper .rdp-nav_button { display: none !important; }

  /* Custom prev/next buttons inside the popper: remove visible border/box and use round hover only */
  .nolsaf-date-popper button[aria-label="Next month"],
  .nolsaf-date-popper button[aria-label="Previous month"] {
    background: transparent !important;
    border: none !important;
    box-shadow: none !important;
    padding: 6px !important;
    width: 36px !important;
    height: 36px !important;
    display: inline-flex !important;
    align-items: center !important;
    justify-content: center !important;
    color: #334155 !important; /* slate-700 */
    transition: background-color .12s ease, transform .06s ease !important;
  }
  .nolsaf-date-popper button[aria-label="Next month"]:hover,
  .nolsaf-date-popper button[aria-label="Previous month"]:hover {
    background: rgba(15, 23, 42, 0.06) !important; /* subtle rounded hover */
    border-radius: 9999px !important;
    transform: translateY(-1px) !important;
  }
  .nolsaf-date-popper button[aria-label="Next month"]:active,
  .nolsaf-date-popper button[aria-label="Previous month"]:active {
    transform: translateY(0) !important;
    background: rgba(15, 23, 42, 0.08) !important;
  }

  /* touched day visual (simulate hover on touch devices) */
  .nolsaf-date-popper .rdp-day.nolsaf-day-touch,
  .nolsaf-date-popper .rdp-day:active {
    background: #10b981 !important; /* use brand/emerald as primary */
    color: white !important;
    border-radius: 6px !important;
    box-shadow: 0 1px 0 rgba(0,0,0,0.06) inset !important;
  }
  .nolsaf-date-popper .rdp-day.nolsaf-day-preview {
    background: rgba(16,185,129,0.12) !important; /* light emerald tint */
    color: #065f46 !important; /* darker green for contrast */
  }

  /* Guest popover header close icon: remove visible box and use rounded hover like chevrons */
  .nolsaf-guest-popper button[aria-label="Close guest selector"] {
    background: transparent !important;
    border: none !important;
    box-shadow: none !important;
    padding: 6px !important;
    width: 36px !important;
    height: 36px !important;
    display: inline-flex !important;
    align-items: center !important;
    justify-content: center !important;
    color: #334155 !important;
    transition: background-color .12s ease, transform .06s ease !important;
    border-radius: 9999px !important;
  }
  .nolsaf-guest-popper button[aria-label="Close guest selector"]:hover {
    background: rgba(15, 23, 42, 0.06) !important;
  }

  /* Expand and refine guest popover card for clarity and visual hierarchy */
  .nolsaf-guest-popper {
    min-width: 320px !important;
    max-width: 460px !important;
    padding: 0 !important; /* inner padding handled by child .p-3 */
    border-radius: 12px !important;
    box-shadow: 0 10px 30px rgba(2,6,23,0.12) !important;
    background: #ffffff !important;
    border: 1px solid rgba(15,23,42,0.06) !important;
  }

  .nolsaf-guest-popper .p-3 {
    padding: 1rem 1.25rem !important;
  }

  .nolsaf-guest-popper .font-medium { font-size: 1rem !important; }
  .nolsaf-guest-popper .text-xs { font-size: 0.78rem !important; color: #475569 !important; }

  /* Slightly increased spacing between guest rows for readability */
  .nolsaf-guest-popper .space-y-3 > * + * { margin-top: 0.85rem !important; }

  /* Larger steppers and consistent button sizing inside popover
     Match the 'Clear' button visual: transparent background, subtle border, rounded corners */
  .nolsaf-guest-popper .inline-flex.items-center.gap-2 button {
    min-width: 36px !important;
    min-height: 36px !important;
    padding: 0.18rem 0.5rem !important;
    font-size: 1.05rem !important;
    background: transparent !important;
    border: 1px solid rgba(15,23,42,0.06) !important; /* subtle slate border */
    border-radius: 6px !important;
    color: #334155 !important; /* slate-700 */
    display: inline-flex !important;
    align-items: center !important;
    justify-content: center !important;
    transition: background-color .12s ease, transform .06s ease !important;
  }
  .nolsaf-guest-popper .inline-flex.items-center.gap-2 button:hover {
    background: rgba(15,23,42,0.04) !important;
  }
  /* Disabled state for steppers: visually match Clear button disabled look */
  .nolsaf-guest-popper .inline-flex.items-center.gap-2 button:disabled,
  .nolsaf-guest-popper .inline-flex.items-center.gap-2 button[aria-disabled="true"] {
    opacity: 0.5 !important;
    cursor: not-allowed !important;
    background: transparent !important;
    border-color: rgba(15,23,42,0.04) !important;
    box-shadow: none !important;
  }
  /* Keyboard focus indicates the same as other popover buttons (clear/done) */
  .nolsaf-guest-popper .inline-flex.items-center.gap-2 button:focus-visible {
    outline: none !important;
    box-shadow: 0 0 0 6px rgba(15,23,42,0.04) !important;
  }

  /* Clear/Done buttons: slightly larger, clearer contrast and spacing */
  .nolsaf-guest-popper .mt-4 .flex.justify-end .px-2,
  .nolsaf-guest-popper .mt-4 .flex.justify-end .px-3 {
    padding: 0.46rem 0.9rem !important;
    font-size: 0.95rem !important;
  }

  /* Improve inner layout: header spacing and alignment */
  .nolsaf-guest-popper .flex.items-center.justify-between {
    gap: 0.5rem !important;
    align-items: center !important;
  }

  /* Make helper text slightly more prominent and readable */
  .nolsaf-guest-popper #preg-help { color: #475569 !important; font-size: 0.8rem !important; }

  /* Pregnancy toggle: make a compact accessible switch with a clear hit target and smooth knob movement */
  .nolsaf-preg-toggle {
    width: 46px !important;
    height: 26px !important;
    padding: 3px !important;
    display: inline-flex !important;
    align-items: center !important;
    justify-content: flex-start !important;
    border-radius: 9999px !important;
    background: rgba(15,23,42,0.06) !important; /* subtle off track */
    border: 1px solid rgba(15,23,42,0.06) !important;
    transition: background-color .16s ease, border-color .16s ease, box-shadow .12s ease !important;
    box-sizing: border-box !important;
  }
  .nolsaf-preg-toggle:focus {
    outline: none !important;
    box-shadow: 0 0 0 6px rgba(16,185,129,0.10) !important; /* subtle emerald focus ring */
  }
  .nolsaf-preg-toggle.is-on {
    background: #10b981 !important; /* emerald */
    border-color: rgba(16,185,129,0.24) !important;
    justify-content: flex-end !important;
  }
  .nolsaf-preg-toggle.is-off {
    background: rgba(15,23,42,0.04) !important;
    border-color: rgba(15,23,42,0.06) !important;
    justify-content: flex-start !important;
  }
  .nolsaf-preg-toggle > .nolsaf-preg-knob {
    width: 18px !important;
    height: 18px !important;
    background: #ffffff !important;
    border-radius: 9999px !important;
    box-shadow: 0 2px 6px rgba(2,6,23,0.12) !important;
    margin: 0 2px !important;
    transition: transform .14s ease, box-shadow .12s ease !important;
  }
  .nolsaf-preg-toggle.is-on > .nolsaf-preg-knob {
    transform: translateX(0) !important; /* knob positioned by justify-content */
  }
  .nolsaf-preg-toggle.is-off > .nolsaf-preg-knob {
    transform: translateX(0) !important;
  }
  .nolsaf-date-popper button.rdp-nav_button,
  .nolsaf-date-popper .rdp-nav button {
    -webkit-appearance: none !important;
    appearance: none !important;
    background: transparent !important;
    border: none !important;
    color: #3b82f6 !important; /* blue */
    width: 36px !important;
    height: 36px !important;
    display: inline-flex !important;
    align-items: center !important;
    justify-content: center !important;
    border-radius: 0.375rem !important;
    transition: background .12s ease !important;
  }
  .nolsaf-date-popper button.rdp-nav_button:hover,
  .nolsaf-date-popper .rdp-nav button:hover {
    background: rgba(59,130,246,0.08) !important;
  }
  /* Ensure the chevron icons don't wrap and sit on the same line as the month header */
  .nolsaf-date-popper .rdp-caption > * { white-space: nowrap !important; }
  /* Mobile: stack months vertically inside bottom sheet */
  @media (max-width: 767px) {
    .nolsaf-date-popper .rdp { display: block; padding: 0; }
    .nolsaf-date-popper .rdp-month { min-width: auto; }
  }
  .dot-blue   { background: #3b82f6; }
  .dot-black  { background: #111827; }
  .dot-yellow { background: #f59e0b; }
  .dot-green  { background: #10b981; }

  @keyframes dot-pulse {
    0%, 100% { transform: translate(-50%, -50%) scale(0.8); opacity: 0.6; }
    50% { transform: translate(-50%, -50%) scale(1.15); opacity: 1; }
  }

  @keyframes dot-rotate {
    to { transform: rotate(360deg); }
  }

  /* Small variant for inline use (e.g. buttons) */
  .dot-spinner.dot-sm {
    width: 16px;
    height: 16px;
    animation-duration: 1s;
  }

  .dot-spinner.dot-sm .dot {
    width: 4px;
    height: 4px;
  }

  .dot-spinner.dot-sm .dot:nth-child(1) { top: 6%; left: 50%; }
  .dot-spinner.dot-sm .dot:nth-child(2) { top: 50%; left: 94%; }
  .dot-spinner.dot-sm .dot:nth-child(3) { top: 94%; left: 50%; }
  .dot-spinner.dot-sm .dot:nth-child(4) { top: 50%; left: 6%; }

  /* Tabs */
  .tabs       { @apply flex items-center gap-2 border-b border-gray-200; }
  .tab        { @apply px-3 py-2 text-sm text-gray-600 hover:text-gray-900; }
  .tab-active { @apply border-b-2 border-brand text-gray-900 font-medium; }

  /* Pagination */
  .pager         { @apply flex items-center gap-1; }
  .page          { @apply inline-flex items-center justify-center h-9 min-w-[2.25rem] rounded-lg border bg-white text-sm text-gray-700 hover:bg-gray-50; }
  .page-current  { @apply border-brand text-brand bg-brand/5; }
  .page-disabled { @apply opacity-50 cursor-not-allowed; }

  /* Skeleton shimmer */
  .skeleton {
    background: linear-gradient(90deg, rgba(0,0,0,0.04) 25%, rgba(0,0,0,0.06) 37%, rgba(0,0,0,0.04) 63%);
    background-size: 480px 100%;
    @apply animate-shimmer rounded-md;
  }
  .skeleton-card { @apply skeleton h-28 w-full rounded-2xl border border-gray-200; }
}

/* ---------- Print-specific styles ---------- */
@media print {
  /* Keep background white and text black for printing */
  body { background: #fff !important; color: #000 !important; }

  /* Hide UI elements not relevant for print */
  .no-print, .admin-sidebar-fixed, .site-header-refresh, .site-header-export, .mini-footer-above, .admin-footer-fixed { display: none !important; }

  /* Print invoice container adjustments */
  .print-invoice { background: #fff !important; box-shadow: none !important; border: none !important; padding: 0.5in !important; max-width: 100% !important; }
  .print-invoice .text-2xl, .print-invoice .text-xl { font-size: 16pt !important; }

  /* Tables: clear borders and comfortable padding for paper */
  .print-invoice table { border-collapse: collapse; width: 100%; }
  .print-invoice th, .print-invoice td { border: 1px solid #ddd; padding: 8px; font-size: 11pt; }
  .print-invoice thead th { background: #f7f7f7; }

  /* Reduce link decoration when printing */
  a { color: #000; text-decoration: none; }

  /* Page margin and size */
  @page { margin: 0.5in; size: A4 portrait; }

  /* Print only the invoice container and footer: hide everything else on the page to avoid printing global chrome */
  body * { visibility: hidden; }
  .print-invoice, .print-invoice * , .invoice-footer, .invoice-footer * { visibility: visible; }
  /* position the printable invoice at the top of the page */
  .print-invoice { position: absolute; left: 0.5in; right: 0.5in; top: 0.5in; }
  /* make footer fixed at bottom */
  .invoice-footer { position: fixed; bottom: 0.25in; left: 0.5in; right: 0.5in; }

  /* Try to scale down larger invoices to fit to one page when possible */
  .print-invoice { transform-origin: top left; transform: scale(0.95); }
}

/* Invoice footer: hidden on screen, visible when printing. Provides company logo, page numbering and a QR code. */
.invoice-footer { display: none; }

@media print {
  /* ensure printed invoice has extra bottom space so footer doesn't overlap content */
  .print-invoice { padding-bottom: 1.6in !important; }

  .invoice-footer { 
    display: flex !important; 
    position: fixed; 
    bottom: 0; 
    left: 0; 
    right: 0; 
    justify-content: space-between; 
    align-items: center; 
    padding: 0.12in 0.5in; 
    background: #fff; 
    border-top: 1px solid rgba(0,0,0,0.08);
    font-size: 10pt;
  }

  .invoice-footer-left, .invoice-footer-right { display: flex; align-items: center; gap: 0.5rem; }
  .invoice-footer-logo { height: 36px; width: auto; display: inline-block; }
  .invoice-footer-company { font-size: 10pt; color: #111827; }
  .invoice-footer-qr { height: 64px; width: 64px; display: inline-block; }

  /* center: page numbering using CSS counters. `counter(pages)` is not supported in all engines but works in modern Chromium/Firefox. */
  .invoice-footer-center { text-align: center; flex: 1 1 auto; }
  .invoice-footer-center.pagenum::after { content: "Page " counter(page) " of " counter(pages); }
}

/* Refresh button: match Settings behavior (transparent base, hover/active/focus) */
.site-header-refresh,
button[aria-label="Refresh"] {
  @apply inline-flex items-center justify-center rounded-xl p-2 hover:bg-white/10;
  background-color: transparent;
  color: #ffffff;
  border-color: transparent;
}

/* Mobile drawer larger touch target variant */
.site-header-refresh-mobile,
button[aria-label="Refresh"].mobile {
  @apply inline-flex h-10 w-10 items-center justify-center rounded-xl transition hover:bg-white/10 active:bg-white/20 focus:outline-none focus-visible:ring-2 focus-visible:ring-white/40;
  background-color: transparent;
  color: #ffffff;
}

/* Export invoices CSV: match Settings behavior (transparent base, hover/active/focus) */
.site-header-export,
button[aria-label="Export Invoices CSV"] {
  @apply inline-flex items-center justify-center rounded-xl p-2 hover:bg-white/10;
  background-color: transparent;
  color: #ffffff; /* icons use currentColor */
  border-color: transparent;
}

.site-header-export-mobile,
button[aria-label="Export Invoices CSV"].mobile {
  @apply inline-flex h-10 w-10 items-center justify-center rounded-xl transition hover:bg-white/10 active:bg-white/20 focus:outline-none focus-visible:ring-2 focus-visible:ring-white/40;
  background-color: transparent;
  color: #ffffff;
}

/* Widget Preferences: match Settings behavior (transparent base, hover/active/focus) */
.site-header-widget,
button[aria-label="Widget Preferences"] {
  @apply inline-flex items-center justify-center rounded-xl p-2 hover:bg-white/10;
  background-color: transparent;
  color: #ffffff; /* icons use currentColor */
  border-color: transparent;
}

.site-header-widget-mobile,
button[aria-label="Widget Preferences"].mobile {
  @apply inline-flex h-10 w-10 items-center justify-center rounded-xl transition hover:bg-white/10 active:bg-white/20 focus:outline-none focus-visible:ring-2 focus-visible:ring-white/40;
  background-color: transparent;
  color: #ffffff;
}

/* Ensure Message, Support and Settings icons render white in header and mobile drawer */
.site-header-actions,
button[aria-label="Messages"],
button[aria-label="Support"],
button[aria-label="Settings"],
a[aria-label="Messages"],
a[aria-label="Support"],
a[aria-label="Settings"] {
  color: #ffffff; /* lucide icons use currentColor */
}

.site-header-actions-mobile,
button[aria-label="Messages"].mobile,
button[aria-label="Support"].mobile,
button[aria-label="Settings"].mobile,
a[aria-label="Messages"].mobile,
a[aria-label="Support"].mobile,
a[aria-label="Settings"].mobile {
  color: #ffffff;
}

/* Theme toggle: match Messages/Support/Settings background and hover behavior */
button[aria-label="Toggle theme"],
a[aria-label="Toggle theme"] {
  @apply inline-flex items-center justify-center rounded-xl p-2 hover:bg-white/10;
  background-color: transparent;
  color: #ffffff; /* ensure icon is white */
  border-color: transparent;
}

button[aria-label="Toggle theme"].mobile,
a[aria-label="Toggle theme"].mobile {
  @apply inline-flex h-10 w-10 items-center justify-center rounded-xl transition hover:bg-white/10 active:bg-white/20 focus:outline-none focus-visible:ring-2 focus-visible:ring-white/40;
  background-color: transparent;
  color: #ffffff;
}

/* Header/Footer helpers */
.nols-header { @apply bg-brand text-white; }
.nols-footer { @apply bg-brand text-white; }

/* Footer separation rail: draws a full-width line at the top of footers to separate content
   from the footer similar to the header rail. Apply `.footer-with-rail` to footer elements. */
.footer-with-rail {
  position: relative;
  /* white footer background with a subtle top rail */
  background-color: #ffffff;
  color: #02665e; /* brand text color for footer */
  border-top: 1px solid rgba(2,102,94,0.06);
}
.footer-with-rail::before {
  content: "";
  position: absolute;
  left: 0;
  right: 0;
  top: 0; /* drawn at the very top of the footer */
  height: 6px; /* rail thickness */
  /* gradient matching the admin header brand — visually connects header and footer */
  background: linear-gradient(90deg, #02665e 0%, #013a37 100%);
  z-index: 5; /* keep the rail behind the sidebar */
}

/* Footer base should not create a new stacking context above the sidebar */
.footer-with-rail { position: relative; z-index: 0; }

/* On md+ screens, don't draw the rail under the fixed left sidebar — start the rail after the sidebar width */
@media (min-width: 768px) {
  .footer-with-rail::before {
    left: var(--admin-sidebar-width);
  }
}

/* Ensure the page content doesn't visually collide with the footer rail when using fixed elements */
.page-bottom-buffer { padding-bottom: calc(var(--footer-height) + 1rem); }

/* Utility to add top padding equal to the fixed header so content is not obscured */
.header-offset { padding-top: var(--header-height); }

/* Public container centers content and removes admin left-rail offset.
  Use this on public pages to align content without the admin sidebar margin. */
.public-container { max-width: 72rem; margin-left: auto; margin-right: auto; padding-left: 1rem; padding-right: 1rem; }

/* Accessibility helper: screen reader only */
.sr-only { position: absolute !important; height: 1px; width: 1px; overflow: hidden; clip: rect(1px, 1px, 1px, 1px); white-space: nowrap; border: 0; padding: 0; }

/* Scrollbars (optional) */
@supports (scrollbar-width: thin) or (scrollbar-color: #000 transparent) {
  * { scrollbar-width: thin; scrollbar-color: theme('colors.gray.300') transparent; }
}
*::-webkit-scrollbar { height: 10px; width: 10px; }
*::-webkit-scrollbar-thumb { background: theme('colors.gray.300'); border-radius: 8px; }
*::-webkit-scrollbar-thumb:hover { background: theme('colors.gray.400'); }

/* Sidebar-specific scrollbar: hide until hover to keep chrome clean */
.sidebar-scroll { overflow-y: auto; }
.sidebar-scroll::-webkit-scrollbar { width: 8px; }
.sidebar-scroll::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.12); transition: background .15s; border-radius: 8px; }
.sidebar-scroll:hover::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.22); }
/* Only apply Firefox/Chromium 121+ coloring when supported */
@supports (scrollbar-color: #000 #fff) {
  .sidebar-scroll { scrollbar-color: rgba(255,255,255,0.12) transparent; }
  .sidebar-scroll:hover { scrollbar-color: rgba(255,255,255,0.22) transparent; }
}

/* Touch helper: prevent default touch panning while interacting with draggable controls */
.touch-action-none { -ms-touch-action: none; touch-action: none; }

/* Subtle blink/pulse for high-attention single words.
   Uses opacity pulse (not hard show/hide) and respects user reduced-motion preference. */
@keyframes nls-blink {
  0% { opacity: 1; }
  50% { opacity: 0.55; }
  100% { opacity: 1; }
}

.nls-blink {
  display: inline-block;
  animation: nls-blink 1s ease-in-out infinite;
}

@media (prefers-reduced-motion: reduce) {
  .nls-blink { animation: none !important; }
}
